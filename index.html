<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Task Manager CRM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #1e1e1e);
            --text-color: var(--tg-theme-text-color, #ffffff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #2b2b2b);
            --btn-color: var(--tg-theme-button-color, #3390ec);
            --btn-text: var(--tg-theme-button-text-color, #ffffff);
            --hint-color: var(--tg-theme-hint-color, #aaaaaa);
            --sidebar-width: 250px;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê (–ú–ï–ù–Æ) --- */
        .sidebar {
            width: 80px; /* –£–∑–∫–∞—è –ø–æ–ª–æ—Å–∫–∞ –Ω–∞ –ü–ö */
            background-color: var(--secondary-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            border-right: 1px solid #3f3f3f;
            transition: width 0.3s;
        }
        
        .sidebar:hover { width: 200px; } /* –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */

        .menu-item {
            width: 100%;
            padding: 15px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--hint-color);
            transition: 0.2s;
        }
        .menu-item:hover, .menu-item.active {
            color: var(--btn-color);
            background-color: rgba(255,255,255,0.05);
        }
        .icon { font-size: 24px; margin-bottom: 5px; }
        .label { display: none; margin-left: 10px; font-size: 14px; white-space: nowrap;}
        .sidebar:hover .label { display: block; }

        /* --- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ --- */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }

        /* --- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê (–ß–ê–¢) --- */
        .chat-sidebar {
            width: 300px;
            background-color: var(--secondary-bg);
            border-left: 1px solid #3f3f3f;
            display: flex;
            flex-direction: column;
        }
        .chat-header {
            padding: 15px;
            border-bottom: 1px solid #3f3f3f;
            font-weight: bold;
        }
        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            font-size: 13px;
        }
        .chat-input-area {
            padding: 10px;
            border-top: 1px solid #3f3f3f;
        }

        /* --- –≠–õ–ï–ú–ï–ù–¢–´ –§–û–†–ú–´ --- */
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s; }

        h2 { margin-top: 0; }
        input, select, textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            background: var(--bg-color);
            border: 1px solid #444;
            color: var(--text-color);
            border-radius: 8px;
            box-sizing: border-box;
            outline: none;
        }
        input:focus { border-color: var(--btn-color); }

        button.primary-btn {
            width: 100%;
            padding: 14px;
            background: var(--btn-color);
            color: var(--btn-text);
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á (–î–ª—è –ø—Ä–∏–º–µ—Ä–∞) */
        .task-card {
            background: var(--secondary-bg);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid var(--btn-color);
        }
        .task-meta { font-size: 12px; color: var(--hint-color); margin-top: 5px; }

        /* --- –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø --- */
        @media (max-width: 768px) {
            body { flex-direction: column; }
            
            .sidebar {
                width: 100%;
                height: 60px;
                flex-direction: row;
                justify-content: space-around;
                order: 3; /* –ú–µ–Ω—é —Å–Ω–∏–∑—É */
                padding: 0;
                border-top: 1px solid #3f3f3f;
                border-right: none;
            }
            .sidebar:hover { width: 100%; }
            .menu-item { flex-direction: column; padding: 5px; }
            .icon { font-size: 20px; margin: 0; }
            .label { display: block; font-size: 10px; margin: 0; }
            
            .main-content { order: 1; padding: 15px; }
            
            .chat-sidebar { display: none; } /* –°–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç –Ω–∞ –º–æ–±–∏–ª–µ –ø–æ–∫–∞ */
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- –õ–ï–í–û–ï –ú–ï–ù–Æ -->
    <div class="sidebar">
        <div class="menu-item active" onclick="showPage('create')">
            <div class="icon">‚ûï</div>
            <div class="label">–°–æ–∑–¥–∞—Ç—å</div>
        </div>
        <div class="menu-item" onclick="showPage('tasks')">
            <div class="icon">üìã</div>
            <div class="label">–ó–∞–¥–∞—á–∏</div>
        </div>
        <div class="menu-item" onclick="showPage('backlog')">
            <div class="icon">üì¶</div>
            <div class="label">Backlog</div>
        </div>
        <div class="menu-item" onclick="showPage('chat-mobile')">
            <div class="icon">üí¨</div>
            <div class="label">–ß–∞—Ç</div>
        </div>
    </div>

    <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –û–ë–õ–ê–°–¢–¨ -->
    <div class="main-content">
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –°–æ–∑–¥–∞–Ω–∏–µ -->
        <div id="create" class="page active">
            <h2>‚ú® –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</h2>
            <label>–°—É—Ç—å –∑–∞–¥–∞—á–∏</label>
            <textarea id="task_text" rows="3" placeholder="–û–ø–∏—à–∏, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å..."></textarea>
            
            <label>–î–µ–¥–ª–∞–π–Ω</label>
            <select id="deadline_select">
                <option value="–°–µ–≥–æ–¥–Ω—è">–°–µ–≥–æ–¥–Ω—è</option>
                <option value="–ó–∞–≤—Ç—Ä–∞">–ó–∞–≤—Ç—Ä–∞</option>
                <option value="–°—Ä–æ—á–Ω–æ">üî• –°—Ä–æ—á–Ω–æ</option>
                <option value="custom">–î—Ä—É–≥–æ–µ...</option>
            </select>
            <input type="text" id="deadline_custom" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 25.12 –≤ 10:00" style="display:none;">

            <button class="primary-btn" onclick="sendTask()">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2: –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á (–î–µ–º–æ) -->
        <div id="tasks" class="page">
            <h2>üìã –ú–æ–∏ –∑–∞–¥–∞—á–∏</h2>
            <p style="color: #aaa; font-size: 12px;">(–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)</p>
            
            <div class="task-card">
                <div>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</div>
                <div class="task-meta">üìÖ –°–µ–≥–æ–¥–Ω—è | üë§ @admin</div>
            </div>
            <div class="task-card" style="border-left-color: #ff5555;">
                <div>–ü–æ—á–∏–Ω–∏—Ç—å –±–∞–≥ –≤ WebApp</div>
                <div class="task-meta">üî• –°—Ä–æ—á–Ω–æ | üë§ @okilaki</div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: Backlog (–î–µ–º–æ) -->
        <div id="backlog" class="page">
            <h2>üì¶ –ë—ç–∫–ª–æ–≥ (–ò–¥–µ–∏)</h2>
            <div class="task-card" style="border-left-color: #aaa;">
                <div>–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Google Calendar</div>
            </div>
            <div class="task-card" style="border-left-color: #aaa;">
                <div>–°–¥–µ–ª–∞—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π</div>
            </div>
        </div>
        
         <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 4: –ß–∞—Ç (–¢–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª–æ–∫) -->
         <div id="chat-mobile" class="page">
            <h2>üí¨ –ß–∞—Ç –≥—Ä—É–ø–ø—ã</h2>
            <div class="chat-messages" style="height: 300px; background: var(--secondary-bg); border-radius: 10px; margin-bottom: 10px;">
                <p style="padding: 10px; color: #888;">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–ø–∏—Å–∫–∏...</p>
            </div>
            <input type="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ...">
        </div>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê (–ß–ê–¢ - –¢–û–õ–¨–ö–û –î–õ–Ø –ü–ö) -->
    <div class="chat-sidebar" id="pc-chat">
        <div class="chat-header">–ö–æ–º–∞–Ω–¥–Ω—ã–π —á–∞—Ç</div>
        <div class="chat-messages">
            <div style="margin-bottom: 10px;">
                <span style="color: var(--btn-color); font-weight: bold;">@admin:</span>
                –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
            </div>
            <div style="margin-bottom: 10px;">
                <span style="color: #ff5555; font-weight: bold;">@okilaki:</span>
                –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω?
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å..." style="margin: 0;">
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        function showPage(pageId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é
            document.getElementById(pageId).classList.add('active');
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ (–ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ)
            event.currentTarget.classList.add('active');
        }

        // –õ–æ–≥–∏–∫–∞ –ø–æ–ª—è –¥–∞—Ç—ã
        document.getElementById('deadline_select').addEventListener('change', function() {
            let customInput = document.getElementById('deadline_custom');
            if (this.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞
        function sendTask() {
            let text = document.getElementById('task_text').value;
            let selectVal = document.getElementById('deadline_select').value;
            let customVal = document.getElementById('deadline_custom').value;
            
            let finalDead = (selectVal === 'custom') ? customVal : selectVal;

            if (!text) {
                tg.showAlert("–ù–∞–ø–∏—à–∏ —Å—É—Ç—å –∑–∞–¥–∞—á–∏!");
                return;
            }

            let data = {
                task: text,
                deadline: finalDead
            };

            tg.sendData(JSON.stringify(data));
        }

        // –ê–¥–∞–ø—Ç–∏–≤ —á–∞—Ç–∞: –Ω–∞ –º–æ–±–∏–ª–∫–µ —Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∞–≤—É—é –ø–∞–Ω–µ–ª—å
        if (window.innerWidth <= 768) {
            document.getElementById('pc-chat').style.display = 'none';
        }
    </script>
</body>
</html>
